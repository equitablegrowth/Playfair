<html>

<head>
	<title>playfair - equitable graphs</title>

	<!-- <script src="lib/saveSvgAsPng.js"></script> -->
	<script src="lib/saveSvgAsPng.js"></script>
	<script src="lib/catmullrom2bezier.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2014-11-29/FileSaver.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.6/moment.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.5.1/snap.svg-min.js"></script>
	<!-- playfair components -->
	<script src="components/context.js"></script>
	<script src="components/miscfunc.js"></script>
	<script src="components/playfair.js"></script>
	<script src="components/textfunc.js"></script>
	<script src="components/savefunc.js"></script>
	<script src="components/loadfunc.js"></script>
	<script src="components/graphfunc.js"></script>

	<!-- stylesheets -->
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="css/keys.css" type="text/css" />
	<link rel="stylesheet" href="css/main.css" type="text/css" />

	<style>
		@import url(http://fonts.googleapis.com/css?family=Lancelot);
		@import url(http://fonts.googleapis.com/css?family=Raleway:300,400,500,600,700,800);
		@import url(http://fonts.googleapis.com/css?family=Open+Sans:400,700,600,300);
		@font-face {font-family:'Macondo';font-style: normal;font-weight: 400;src: url(fonts/Macondo-Regular.ttf) format('truetype');}
		@font-face {font-family:'Archivo';font-style: normal;font-weight: 400;src: url(fonts/ArchivoNarrow-Regular.ttf) format('truetype');}
		@font-face {font-family:'Archivo';font-style: normal;font-weight: 600;src: url(fonts/ArchivoNarrow-Bold.ttf) format('truetype');}
		@font-face {font-family:'PTSans';font-style: normal;font-weight: 400;src: url(fonts/PT_Sans-Web-Regular.ttf) format('truetype');}
		@font-face {font-family:'PTSans';font-style: normal;font-weight: 600;src: url(fonts/PT_Sans-Web-Bold.ttf) format('truetype');}
		@font-face {font-family:'Asap';font-style: normal;font-weight: 400;src: url(fonts/Asap-Regular.ttf) format('truetype');}
		@font-face {font-family:'Asap';font-style: normal;font-weight: 600;src: url(fonts/Asap-Bold.ttf) format('truetype');}
		@font-face {font-family:'BreeSerif';font-style: normal;font-weight: 400;src: url(fonts/BreeSerif-Regular.ttf) format('truetype');}
		@font-face {font-family:'Cabin';font-style: normal;font-weight: 400;src: url(fonts/Cabin-Regular.ttf) format('truetype');}
		@font-face {font-family:'Cabin';font-style: normal;font-weight: 600;src: url(fonts/Cabin-Bold.ttf) format('truetype');}
		@font-face {font-family:'Cuprum';font-style: normal;font-weight: 400;src: url(fonts/Cuprum-Regular.ttf) format('truetype');}
		@font-face {font-family:'Cuprum';font-style: normal;font-weight: 600;src: url(fonts/Cuprum-Bold.ttf) format('truetype');}
		@font-face {font-family:'Dosis';font-style: normal;font-weight: 400;src: url(fonts/Dosis-Regular.ttf) format('truetype');}
		@font-face {font-family:'Dosis';font-style: normal;font-weight: 600;src: url(fonts/Dosis-Bold.ttf) format('truetype');}
		@font-face {font-family:'FjallaOne';font-style: normal;font-weight: 400;src: url(fonts/FjallaOne-Regular.ttf) format('truetype');}
		@font-face {font-family:'Karma';font-style: normal;font-weight: 400;src: url(fonts/Karma-Regular.ttf) format('truetype');}
		@font-face {font-family:'Karma';font-style: normal;font-weight: 600;src: url(fonts/Karma-Bold.ttf) format('truetype');}
		@font-face {font-family:'Lato';font-style: normal;font-weight: 400;src: url(fonts/Lato-Regular.ttf) format('truetype');}
		@font-face {font-family:'Lato';font-style: normal;font-weight: 600;src: url(fonts/Lato-Bold.ttf) format('truetype');}
		@font-face {font-family:'Lato';font-style: normal;font-weight: 200;src: url(fonts/Lato-Light.ttf) format('truetype');}
		@font-face {font-family:'Lora';font-style: normal;font-weight: 400;src: url(fonts/Lora-Regular.ttf) format('truetype');}
		@font-face {font-family:'Lora';font-style: normal;font-weight: 600;src: url(fonts/Lora-Bold.ttf) format('truetype');}
		@font-face {font-family:'Marvel';font-style: normal;font-weight: 400;src: url(fonts/Marvel-Regular.ttf) format('truetype');}
		@font-face {font-family:'Marvel';font-style: normal;font-weight: 600;src: url(fonts/Marvel-Bold.ttf) format('truetype');}
		@font-face {font-family:'NewsCycle';font-style: normal;font-weight: 400;src: url(fonts/NewsCycle-Regular.ttf) format('truetype');}
		@font-face {font-family:'NewsCycle';font-style: normal;font-weight: 600;src: url(fonts/NewsCycle-Bold.ttf) format('truetype');}
		@font-face {font-family:'Nunito';font-style: normal;font-weight: 400;src: url(fonts/Nunito-Regular.ttf) format('truetype');}
		@font-face {font-family:'Nunito';font-style: normal;font-weight: 600;src: url(fonts/Nunito-Bold.ttf) format('truetype');}
		@font-face {font-family:'Oswald';font-style: normal;font-weight: 400;src: url(fonts/Oswald-Regular.ttf) format('truetype');}
		@font-face {font-family:'Oswald';font-style: normal;font-weight: 600;src: url(fonts/Oswald-Bold.ttf) format('truetype');}
	</style>
</head>

<!-- ********************************************** -->
<!-- ***************** SAVE DIALOG **************** -->
<!-- ********************************************** -->

<div class='savedialog' id='savedialog'>
</div>

<div class='savebox' id='savebox'>
	<div class='row marginfix'>
		<div class='col-md-12'>
		<div class='col-md-12'>
			  Save as:
			  <input type="text" class="form-control" placeholder="A descriptive name for this chart" id='savename'>
			</div>
		</div>
	</div>
	<br>
	<div class='row marginfix'>
		<div class='col-md-12'>
			<div class='col-md-12'>
				<ul class='filebox' id='save_filebox'>
				</ul>
			</div>
		</div>
	</div>
	<br>
	<div class='row'>
		<div class='col-md-12 text-center'>
			<div class="btn-group btnpadding" role="group">
				<button type="button" class="btn btn-default" id='cancelsave' onclick=cancelsave()>Cancel</button>
				<button type="button" class="btn btn-default" id='savetoserver' onclick=savetoserver()>Save</button>
			</div>
		</div>
	</div>
</div>


<!-- ********************************************** -->
<!-- ***************** LOAD DIALOG **************** -->
<!-- ********************************************** -->

<div class='savebox' id='loadbox'>
	<div class='row marginfix'>
		<div class='col-md-12'>
		<div class='col-md-12'>
			Search:
			<input type='text' class='form-control' placeholder='Start typing to search' id='searchahead'>
		</div>
		</div>
	</div>
<br>
	<div class='row marginfix'>
		<div class='col-md-12'>
			<div class='col-md-12'>
				<div class='list-group' id='load_filebox'>
				</div>
			</div>
		</div>
	</div>
	<br>
	<div class='row'>
		<div class='col-md-12 text-center'>
			<div class="btn-group btnpadding" role="group">
				<button type="button" class="btn btn-default" id='cancelload' onclick=cancelload()>Cancel</button>
				<button type="button" class="btn btn-default" id='loadfromserver' onclick=loadfromserver()>Load</button>
			</div>
		</div>
	</div>
</div>

<!-- ********************************************** -->
<!-- ********** CONTEXTUAL MENU CONTENTS ********** -->
<!-- ********************************************** -->

<div class="contextMenuContainer" id='text_context_menu'>
	<ul class="contextMenu">
		<li onclick=movetofront(clickedevent.target) class='highlight'>Move to Front</li>
		<li onclick=deleteelement(clickedevent.target) class='highlight'>Delete Text</li>
		<hr>
		<li><span class='contextbuttons' onclick=boldtext(clickedevent.target)><i class="fa fa-bold"></i></span><span class='contextbuttons' onclick=italictext(clickedevent.target)><i class="fa fa-italic"></i></span><span class='contextbuttons' onclick=sizeup(clickedevent.target)><i class="fa fa-font"></i> <i class="fa fa-angle-up"></i></span><span class='contextbuttons' onclick=sizedown(clickedevent.target)><i class="fa fa-font"></i> <i class="fa fa-angle-down"></i></span></li>
		<li><span class='contextbuttons' onclick=leftalign(clickedevent.target)><i class="fa fa-align-left"></i></span><span class='contextbuttons' onclick=center(clickedevent.target)><i class="fa fa-align-center"></i></span><span class='contextbuttons' onclick=rightalign(clickedevent.target)><i class="fa fa-align-right"></i></span></li>
		<hr>
		<li>Opacity: <span class='contextbuttons' onclick=fadein(clickedevent.target)><i class="fa fa-eye" style='opacity:1'></i></span><span class='contextbuttons' onclick=fadeout(clickedevent.target)><i class="fa fa-eye" style='opacity:.2'></i></span></li>
		<hr>
	</ul>
	<ul class='colormenu'>
	</ul>
</div>

<div class="contextMenuContainer" id='other_context_menu'>
	<ul class="contextMenu">
		<li onclick=startpath(clickedevent) class='highlight'>Start Path</li>
		<li onclick=startarrow(clickedevent) class='highlight'>Start Arrow</li>
		<li onclick=startline(clickedevent) class='highlight'>Start Line</li>
		<hr>
		<li onclick=addtext(clickedevent) class='highlight'>Add Text</li>
	</ul>
</div>

<div class="contextMenuContainer" id='path_context_menu'>
	<ul class="contextMenu">
		<li onclick=movetofront(clickedevent.target) class='highlight'>Move to Front</li>
		<hr>
		<li>Width: <span class='contextbuttons' onclick=thickpath(clickedevent.target)><i class="fa fa-expand"></i></span><span class='contextbuttons' onclick=thinpath(clickedevent.target)><i class="fa fa-compress"></i></span></li>
		<hr>
		<li>Opacity: <span class='contextbuttons' onclick=fadein(clickedevent.target)><i class="fa fa-eye" style='opacity:1'></i></span><span class='contextbuttons' onclick=fadeout(clickedevent.target)><i class="fa fa-eye" style='opacity:.2'></i></span></li>
		<hr>
	</ul>
	<ul class='contextMenu linetype'>
	</ul>
	<hr>
	<ul class='colormenu'>
	</ul>
</div>

<div class="contextMenuContainer" id='pathdata_context_menu'>
	<ul class="contextMenu">
		<li onclick=movetofront(clickedevent.target) class='highlight'>Move to Front</li>
		<li onclick=labeldata(clickedevent.target) class='highlight'>Label Data</li>
		<hr>
		<li>Width: <span class='contextbuttons' onclick=thickpath(clickedevent.target)><i class="fa fa-expand"></i></span><span class='contextbuttons' onclick=thinpath(clickedevent.target)><i class="fa fa-compress"></i></span></li>
		<hr>
		<li>Opacity: <span class='contextbuttons' onclick=fadein(clickedevent.target)><i class="fa fa-eye" style='opacity:1'></i></span><span class='contextbuttons' onclick=fadeout(clickedevent.target)><i class="fa fa-eye" style='opacity:.2'></i></span></li>
		<hr>
	</ul>
	<ul class='contextMenu linetype'>
	</ul>
	<hr>
	<ul class='colormenu'>
	</ul>
</div>

<div class="contextMenuContainer" id='data_context_menu'>
	<ul class="contextMenu">
		<li onclick=movetofront(clickedevent.target) class='highlight'>Move to Front</li>
		<li onclick=labeldata(clickedevent.target) class='highlight'>Label Data</li>
		<li onclick=addtext(clickedevent) class='highlight'>Add Text</li>
		<hr>
		<li onclick=startpath(clickedevent) class='highlight'>Start Path</li>
		<li onclick=startarrow(clickedevent) class='highlight'>Start Arrow</li>
		<li onclick=startline(clickedevent) class='highlight'>Start Line</li>
		<hr>
		<li>Opacity: <span class='contextbuttons' onclick=fadein(clickedevent.target)><i class="fa fa-eye" style='opacity:1'></i></span><span class='contextbuttons' onclick=fadeout(clickedevent.target)><i class="fa fa-eye" style='opacity:.2'></i></span></li>
		<hr>
	</ul>
	<ul class='colormenu'>
	</ul>
</div>

<div class="contextMenuContainer" id='point_context_menu'>
	<ul class="contextMenu">
		<li onclick=movetofront(clickedevent.target) class='highlight'>Move to Front</li>
		<li onclick=labeldata(clickedevent.target) class='highlight'>Label Data</li>
		<li onclick=addtext(clickedevent) class='highlight'>Add Text</li>
		<hr>
		<li onclick=startpath(clickedevent) class='highlight'>Start Path</li>
		<li onclick=startarrow(clickedevent) class='highlight'>Start Arrow</li>
		<li onclick=startline(clickedevent) class='highlight'>Start Line</li>
		<hr>
		<li><span class='pointcirclecontext' onclick=pointtype(clickedevent.target,'pointcircle')></span><span class='pointpointcontext' onclick=pointtype(clickedevent.target,'pointpoint')></span><span class='pointcircleopencontext' onclick=pointtype(clickedevent.target,'pointcircleopen')></span></li>
		<hr>
		<li>Size: <span class='contextbuttons' onclick=thickcircle(clickedevent.target)><i class="fa fa-expand"></i></span><span class='contextbuttons' onclick=thincircle(clickedevent.target)><i class="fa fa-compress"></i></span></li>
		<hr>
		<li>Opacity: <span class='contextbuttons' onclick=fadein(clickedevent.target)><i class="fa fa-eye" style='opacity:1'></i></span><span class='contextbuttons' onclick=fadeout(clickedevent.target)><i class="fa fa-eye" style='opacity:.2'></i></span></li>
		<hr>
	</ul>
	<ul class='colormenu'>
	</ul>
</div>

<div class="contextMenuContainer" id='callout_context_menu'>
	<ul class="contextMenu">
		<li onclick=movetofront(clickedevent.target) class='highlight'>Move to Front</li>
		<li onclick=deleteelement(clickedevent.target) class='highlight'>Delete Line</li>
		<hr>
		<li>Width: <span class='contextbuttons' onclick=thickpath(clickedevent.target)><i class="fa fa-expand"></i></span><span class='contextbuttons' onclick=thinpath(clickedevent.target)><i class="fa fa-compress"></i></span></li>
		<hr>
		<li>Opacity: <span class='contextbuttons' onclick=fadein(clickedevent.target)><i class="fa fa-eye" style='opacity:1'></i></span><span class='contextbuttons' onclick=fadeout(clickedevent.target)><i class="fa fa-eye" style='opacity:.2'></i></span></li>
		<hr>
	</ul>
	<ul class='contextMenu linetype'>
	</ul>
	<hr>
	</ul>
	<ul class='colormenu'>
	</ul>
</div>

<div class="contextMenuContainer" id='color_context_menu'>
	<ul class="contextMenu">
		<li onclick=movetofront(clickedevent.target) class='highlight'>Move to Front</li>
		<li onclick=addtext(clickedevent) class='highlight'>Add Text</li>
		<hr>
		<li onclick=startpath(clickedevent) class='highlight'>Start Path</li>
		<li onclick=startarrow(clickedevent) class='highlight'>Start Arrow</li>
		<li onclick=startline(clickedevent) class='highlight'>Start Line</li>
		<hr>
		<li>Opacity: <span class='contextbuttons' onclick=fadein(clickedevent.target)><i class="fa fa-eye" style='opacity:1'></i></span><span class='contextbuttons' onclick=fadeout(clickedevent.target)><i class="fa fa-eye" style='opacity:.2'></i></span></li>
		<hr>
	</ul>
	<ul class='colormenu'>
	</ul>
</div>


<body>
<!-- ********************************************************************** -->
<!-- ************************** BODY STARTS HERE ************************** -->
<!-- ********************************************************************** -->
<div class='container-fluid'>

<!-- Header -->
<div class='header'>
	<h1 class='text-center'>playfair</h1>
	<div class='h4'>compatible with <img height=20 src='img/chrome.png'> and <img height=25 src='img/firefox.png'></div>
	<div class='h4'>v2.4  <a href='changelog.html'>changelog</a></div>
	<!-- Tabs -->
	<ul class="nav nav-tabs" id='maintabs'>
		<li class="active"><a data-toggle="tab" href="#data">Data</a></li>
		<li><a data-toggle="tab" href="#design">Design</a></li>
		<li><a data-toggle='tab' href="#legend">Legend</a></li>
		<li><a data-toggle="tab" href="#chart">Chart</a></li>
		<!-- <li class='disabled'><a href="#waffle">Waffle</a></li>	 -->
		<li><a data-toggle="tab" href="#map">Map</a></li> 
		<li><a data-toggle="tab" href="#smallmultiples">Small Multiples</a></li> 
		<li><a data-toggle='tab' href="#settings">Settings</a></li>
		<li class='list_button' onclick='reset()'>Reset all fields</a></li>
	</ul>
</div>
<div class='tab-container'>
<div class="tab-content">

<!-- ********************************************************************** -->
<!-- ************************** DATA STARTS HERE ************************** -->
<!-- ********************************************************************** -->

	<div id='data' class='tab-pane active'>
		<div class='v-nav'>
			<ul class='unselectable'>
			<!-- <div class='fakerow'> -->
				<li id='data_first' tab='data_main' class='first current'>Data Entry</li>
			<!-- </div> -->
			</ul>

			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-12'>
						<textarea id='data_text' rows="6" onchange=loadData() placeholder='Paste your data into this box. You can paste directly from Excel or a CSV. Make sure you include the column headers and check the box that appears to make sure your data was parsed correctly.'></textarea>
					</div>
				</div>

				<div class='row'>
					<div class='col-md-12'>
						<div class="alert alert-success" role="alert" id='bad_data'><b>Enter some data and I'll diagnose it for you.</b></div>
					</div>
				</div>
			</div>
		</div>
	</div>

<!-- ********************************************************************** -->
<!-- ************************* DESIGN STARTS HERE ************************* -->
<!-- ********************************************************************** -->

	<div id="design" class="tab-pane">
		<div class='v-nav'>
			<ul class='unselectable'>
				<li id='design_first' tab='design_textelements' class='first current'>Text Elements</li>
				<li tab='design_style'>Style</li>
				<li tab='design_axes'>Axes</li>
			</ul>

			<div class='tab-content'>
				<div class='row'>
					<div class="col-md-6">
						<div class="labeled_ele">
							<label>Headline</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="A Great Chart" id='hed'>
							</span>
						</div>
						<div class="labeled_ele">
							<label>Source</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="Where this data comes from" id='source'>
							</span>
						</div>
						<div class="labeled_ele">
							<label>X Label</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="A label for the x-axis" id='xlabel'>
							</span>
						</div>
					</div>
					<div class="col-md-6">
						<div class="labeled_ele">
							<label>Subhead</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="More detail about this great chart" id='dek'>
							</span>
						</div>
						<div class="labeled_ele">
							<label>Note</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="Another thing you should know" id='note'>
							</span>
						</div>
						<div class="labeled_ele">
							<label>Y Label</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="A label for the y-axis" id='ylabel'>
							</span>
						</div>
					</div>
				</div>
			</div>

			<div class='tab-content'>
				<div class="row">
					<div class="col-md-6">
						<div class="labeled_ele">
							<label>Theme</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="" id='themes' onchange=change_theme() disabled>
										<option value='none'>Default</option>
									</select>
								</span>
							</span>
						</div>
						<div class='uibox'>
						<div class='uibox_text'>Logo</div>
							<input id='nologo' type='radio' name='logo' value='nologo'><label for='nologo'><span><span></span></span>None</label>
							<input id='brlogo' type='radio' name='logo' value='brlogo' checked><label for='brlogo'><span><span></span></span>Bottom-right</label>
						</div>
					</div>

					<div class="col-md-6">
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>Width</label>
								<span class='styled-input'>
									<input type="text styled-input" placeholder="745" id='gwidth' onchange="changedimensions()">
								</span>
							</div>
						</div>
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>Height</label>
								<span class='styled-input'>
									<input type="text styled-input" placeholder="520" id='gheight' onchange="changedimensions()">
								</span>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class='uibox'>
						<div class='uibox_text'>Custom Axes</div>
							<div class='col-md-6'>
								<div class='tableswitch'>
									<div class='switchcell'>
										<input type="checkbox" id="customxcheck" name="customxcheck" class="switch" />
										<label for="customxcheck" style='color:#eee'>.</label>
									</div>
									<div class='textinputcell'>
										<div class="labeled_ele">
											<label>X-axis</label>
											<span class='styled-input'>
												<input type="text styled-input" placeholder="e.g. 1,2,3" id='customx'>
											</span>
										</div>
									</div>
								</div>

								<div class='tableswitch'>
									<div class='switchcell'>
										<input type="checkbox" id="customycheck" name="customycheck" class="switch" />
										<label for="customycheck" style='color:#eee'>.</label>
									</div>
									<div class='textinputcell'>
										<div class="labeled_ele">
											<label>Y-axis</label>
											<span class='styled-input'>
												<input type="text styled-input" placeholder="e.g. 1,2,3" id='customy'>
											</span>
										</div>
									</div>
								</div>

								<div class='tableswitch'>
									<div class='switchcell'>
										<input type="checkbox" id="xlimitscheck" name="xlimitscheck" class="switch" />
										<label for="xlimitscheck" style='color:#eee'>.</label>
									</div>
									<div class='textinputcell'>
										<div class="labeled_ele">
											<label>X limits</label>
											<span class='styled-input'>
												<input type="text styled-input" placeholder="e.g. 0,4" id='xlimits'>
											</span>
										</div>
									</div>
								</div>

								<div class='tableswitch'>
									<div class='switchcell'>
										<input type="checkbox" id="ylimitscheck" name="ylimitscheck" class="switch" />
										<label for="ylimitscheck" style='color:#eee'>.</label>
									</div>
									<div class='textinputcell'>
										<div class="labeled_ele">
											<label>Y limits</label>
											<span class='styled-input'>
												<input type="text styled-input" placeholder="e.g. 0,4" id='ylimits'>
											</span>
										</div>
									</div>
								</div>

							</div>
						</div>
					</div>
					<div class="col-md-6">
						<div class='uibox'>
						<div class='uibox_text'>Gridlines</div>
							<div class='row'>
								<div class="col-md-5">
									<div>
										<input type="checkbox" id="xgrid" name="xgrid" class="switch" />
										<label for="xgrid">X gridlines</label>
									</div>
									<div>
										<input type="checkbox" id="ygrid" name="ygrid" class="switch" checked />
										<label for="ygrid">Y gridlines</label>
									</div>
								</div>

								 <div class="col-md-7">
								 	<div>
										<input type="checkbox" id="xminorgrid" name="xminorgrid" class="switch" />
										<label for="xminorgrid">X minor gridlines</label>
									</div>
									<div>
										<input type="checkbox" id="yminorgrid" name="yminorgrid" class="switch" />
										<label for="yminorgrid">Y minor gridlines</label>
									</div>
								</div>
							</div>
						</div>

						<div class='uibox'>
						<div class='uibox_text'>Log Axes</div>
							<div class='row'>
								<div class="col-md-5">
									<div>
										<input type="checkbox" id="logx" name='logx' class="switch" />
										<label for="logx">Log X axis</label>
									</div>
								</div>
								 <div class="col-md-7">
								 	<div>
										<input type="checkbox" id="logy" name='logy' class="switch" />
										<label for="logy">Log Y axis</label>
									</div>
								</div>
							</div>
						</div>
					</div> 

				</div>
			</div>
		</div>
	</div>

<!-- ********************************************************************** -->
<!-- ************************* LEGEND STARTS HERE ************************* -->
<!-- ********************************************************************** -->

	<div id='legend' class='tab-pane'>
		<div class='v-nav'>
			<ul class='unselectable'>
				<li id='legend_first' tab='legend_main' class='first current'>Legend Design</li>
			</ul>

			<div class='tab-content'>
				<div class='row'>
					<div class="col-md-6">
						<div class="labeled_ele">
							<label>Title</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="Leave this blank to omit a title." id='legtitle'>
							</span>
						</div>
						<div class="labeled_ele">
							<label>Width</label>
							<span class='styled-input'>
								<input type="text styled-input" placeholder="Set the width of the legend." id='legwidth'>
							</span>
						</div>

<!-- 						<div class='uibox'>
						<div class='uibox_text'>Key</div>
							<input id='topkey' type='radio' name='key' value='top'><label for='topkey'><span><span></span></span>Top</label>
							<input id='floatkey' type='radio' name='key' value='float' checked><label for='floatkey'><span><span></span></span>Float</label>
						</div> -->
						<button type="button" class="btn btn-default" id='redraw2' onclick='$(".variable_select").trigger("change")'>Reset legend</button>
					</div>
					<div class='cold-md-6'>
						<div class='uibox' id='PREVIEWbase'>
						<div class='uibox_text'>Preview</div>
							<div id='PREVIEW'>
							Select your variables from the chart tab, then come back here to see a preview of the legend and to make modifications. Currently, no legend will be created.
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

<!-- ********************************************************************** -->
<!-- ************************ CHART STARTS HERE ************************ -->
<!-- ********************************************************************** -->
	<div id='chart' class='tab-pane'>
		<div class='v-nav'>
			<ul class='unselectable'>
				<li id='chart_first' tab='chart_points' class='first current'>Points</li>
				<li tab='chart_lines'>Lines</li>
				<li tab='chart_bars'>Bars</li>
				<li tab='chart_stackedbar'>Stacked Bars</li>
				<li tab='chart_area'>Area</li>
				<li tab='chart_text'>Text</li>
				<li tab='chart_text'>Segments/Trend Lines</li>
				<li tab='chart_text'>Shading</li>
				<li tab='chart_text'>Steps</li>
				<li tab='chart_text'>Rectangles</li>
				<!-- <li tab='chart_text'>Density</li> -->
			</ul>

<!-- POINTS -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='point_select_x' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Point Color</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='point_select_color' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Point Labels</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='point_select_label' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Y Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='point_select_y' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Point Size</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='point_select_size' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Point Types</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select2 group_select" id='point_select_types' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
				</div>
				<div class='row'>
					<div class='col-md-6'>
						<div class='uibox'>
						<div class='uibox_text'>Point Style</div>

							<div class='col-md-6'>
								<div>
									<input type="checkbox" id="labels" name="labels" class="switch" />
									<label for="labels">Label all points</label>
								</div>
							</div>
							<div class='col-md-6'>
								<div>
									<input id='pointcircle' type="radio" name="linepoint" value="pointcircle" checked><label for='pointcircle'><span><span></span></span></label><span class='pointcircle'></span>
									<input id='pointpoint' type="radio" name="linepoint" value="pointpoint"><label for='pointpoint'><span><span></span></span></label><span class='pointpoint'></span>
									<input id='pointcircleopen' type="radio" name="linepoint" value="pointcircleopen"><label for='pointcircleopen'><span><span></span></span></label><span class='pointcircleopen'></span>
								</div>
							</div>
						</div>
					</div>
					<div class='col-md-6'>
					</div>
				</div>
			</div>

<!-- LINES -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='line_select_x' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Connect On</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='line_select_connect' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Line Size</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='line_select_size' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Y Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='line_select_y' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Line Color</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='line_select_color' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Line Types</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='line_select_type' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
				</div>
				<div class='row'>
					<div class='col-md-6'>
						<div class='uibox'>
						<div class='uibox_text'>Line Style</div>
							<div class='col-md-6'>
								<div>
									<input type="checkbox" id="smoothlines" name="smoothlines" class="switch" />
									<label for="smoothlines">Smooth lines</label>
								</div>
							</div>
						</div>
					</div>
					<div class='col-md-6'>
					</div>
				</div>
			</div>

<!-- BARS -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='bar_select_x' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Color</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='bar_select_color' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Y Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='bar_select_y' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

					</div>
				</div>

				<div class='row'>
					<div class='col-md-6'>
						<div class='uibox'>
						<div class='uibox_text'>Bar Style</div>
							<div class='row'>
								<div class='col-md-6'>
									<div>
										<input type="checkbox" id="spacing" name="spacing" class="switch" checked/>
										<label for="spacing">Bar Spacing</label>
									</div>
								</div>
								<div class='col-md-6'>
									<div>
										<input type="checkbox" id="orientation" name="orientation" class="switch" checked/>
										<label for="orientation">Vertical Bars</label>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class='col-md-6'>
					</div>
				</div>
			</div>

<!-- STACKED BARS -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='sbar_select_x' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Color</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='sbar_select_color' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Y Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='sbar_select_y' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
				</div>

				<div class='row'>
					<div class='col-md-6'>
						<div class='uibox'>
						<div class='uibox_text'>Bar Style</div>
							<div class='row'>
								<div class='col-md-6'>
									<div>
										<input type="checkbox" id="sspacing" name="sspacing" class="switch" checked/>
										<label for="sspacing">Bar Spacing</label>
									</div>
								</div>
								<div class='col-md-6'>
									<div>
										<input type="checkbox" id="sorientation" name="sorientation" class="switch" checked/>
										<label for="sorientation">Vertical Bars</label>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class='col-md-6'>
					</div>
				</div>
			</div>

<!-- AREA -->
			<div class='tab-content'>
			<div class='row'>
				<div class='uibox'>
				<div class='uibox_text'>Stacked Areas</div>
					<div class='row'>
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>X Variable</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select x_select" id='area_select_x' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>Color</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select group_select" id='area_select_color' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>
						</div>
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>Y Variable</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select y_select" id='area_select_y' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>
						</div>
					</div>
				</div>

				<div class='uibox'>
				<div class='uibox_text'>Top/bottom bounded areas</div>
					<div class='row'>
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>Y Maximum</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select y_select" id='bounded_select_max' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>X Variable</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select x_select" id='bounded_select_x' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>
						</div>
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>Y Minimum</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select y_select" id='bounded_select_min' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>Color</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select group_select" id='bounded_select_color' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>
						</div>
					</div>
				</div>
			</div>
			</div>

<!-- TEXT -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='text_select_x' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Text</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='text_select_text' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Y Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='text_select_y' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Text Size</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='text_select_size' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
				</div>
			</div>

<!-- SEGMENTS/TREND LINES -->
			<div class='tab-content'>

				<div class='row'>
				<div class='uibox'>
				<div class='uibox_text'>Segments</div>
					<div class='row'>
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>X Start</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select x_select" id='segment_select_xstart' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>X End</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select x_select" id='segment_select_xend' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>Color</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select group_select" id='segment_select_color' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>Size</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select group_select" id='segment_select_size' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>
						</div>
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>Y Start</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select y_select" id='segment_select_ystart' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>Y End</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select group_select" id='segment_select_yend' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>

							<div class="labeled_ele">
								<label>Types</label>
								<span class='styled-select'>
									<span class='select_carat'>
										<select class="variable_select group_select" id='segment_select_type' disabled>
											<option value='none'>Nothing selected</option>
										</select>
									</span>
								</span>
							</div>
						</div>
					</div>
				</div>
				</div>

				<div class='row'>
				<div class='uibox'>
				<div class='uibox_text'>Trendlines</div>
					<div class='row'>
						<div class='col-md-12'>
							<textarea id='trend_text' rows="6" placeholder='To generate labeled trendlines, enter the start and end coordinates for each line as an array with two elements. For example: [[1,3],[2,4]], [[8,3],[-2,4]] would generate a trend line from the point (1,3) to (2,4) and also from (8,3) to (-2,4). For dates, you can enter coordinates like this: [[1/1/1917,5],[1/1/1975,12]] to get a line that runs from the y-value 5 in 1917 to the y-value 12 in 1975.'></textarea>
						</div>
					</div>
				</div>
				</div>
			</div>

<!-- SHADING -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_elewide">
							<label>Vertical Shading</label>
							<span class='styled-inputwide'>
								<input type="text styled-input" placeholder="e.g. [3,4],[9,10] or [01-1997,02-2000], ..." id='shade_select_x' onchange=$(".variable_select").change()>
							</span>
						</div>

						<div class="labeled_elewide">
							<label>Horizontal Shading</label>
							<span class='styled-inputwide'>
								<input type="text styled-input" placeholder="e.g. [3,4],[9,10] or [01-1997,02-2000], ..." id='shade_select_y' onchange=$(".variable_select").change()>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_elewide">
							<label>Legend Label</label>
							<span class='styled-inputwide'>
								<input type="text styled-input" placeholder="Label for shading in legend" id='shade_label' onchange=$(".variable_select").change()>
							</span>
						</div>
						<div>
							<input type="checkbox" id="recessions" name="recessions" class="switch" onclick=$(".variable_select").change() />
							<label for="recessions">Shade U.S. Recessions</label>
						</div>
					</div>
				</div>
			</div>

<!-- STEPS -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='step_select_x' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Connect On</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='step_select_connect' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Step Size</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='step_select_size' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Y Variable</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='step_select_y' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Step Color</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='step_select_color' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Step Types</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='step_select_type' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
				</div>
			</div>


<!-- RECTANGLES -->
			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X Start</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='rect_xstart' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Y Start</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='rect_ystart' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Color</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select group_select" id='rect_color' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>X End</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='rect_xend' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>

						<div class="labeled_ele">
							<label>Y End</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='rect_yend' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>

<!-- ********************************************************************** -->
<!-- ************************** MAP STARTS HERE *************************** -->
<!-- ********************************************************************** -->
	<div id='map' class='tab-pane'>
		<div class='v-nav'>
			<ul class='unselectable'>
			<!-- <div class='fakerow'> -->
				<li id='map_first' tab='map_main' class='first current'>Choropleth</li>
			<!-- </div> -->
			</ul>

			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Locations</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='map_location' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
						<div class="labeled_ele">
							<label>Category</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='map_category' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Values</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select y_select" id='map_values' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
						<div class="labeled_ele">
							<label>Geography</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select id='map_geography'>
									</select>
								</span>
							</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


<!-- ********************************************************************** -->
<!-- ******************* SMALL MULTIPLES STARTS HERE ********************** -->
<!-- ********************************************************************** -->
	<div id='smallmultiples' class='tab-pane'>
		<div class='v-nav'>
			<ul class='unselectable'>
			<!-- <div class='fakerow'> -->
				<li id='smallmultiples_first' tab='smallmultiples_main' class='first current'>Facets</li>
			<!-- </div> -->
			</ul>

			<div class='tab-content'>
				<div class='row'>
					<div class='col-md-6'>
						<div class="labeled_ele">
							<label>Facets</label>
							<span class='styled-select'>
								<span class='select_carat'>
									<select class="variable_select x_select" id='facet_variable' disabled>
										<option value='none'>Nothing selected</option>
									</select>
								</span>
							</span>
						</div>
					</div>
					<div class="col-md-6">
						<div class='col-md-6'>
							<div class="labeled_ele">
								<label>Columns</label>
								<span class='styled-input'>
									<input type="text styled-input" placeholder="1" id='fcolumns'>
								</span>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

<!-- ********************************************************************** -->
<!-- *********************** SETTINGS STARTS HERE ************************* -->
<!-- ********************************************************************** -->
	<div id="settings" class="tab-pane">
		<div class='v-nav'>
			<ul class='unselectable'>
			</ul>
		</div>
	</div>

<!-- ************************* END TAB CONTENT **************************** -->
</div>
</div>
<!-- <hr> -->
<br>

<div class='text-center' id='graphdiv'>

<div id='constraint'>

<div class='helpboxouter'>
	<div class='helpbox' id='help_general'>
		<p><span class='helphighlight'><b>Hover</b></span> an element to highlight it temporarily.</p>
		<p><span class='helphighlight'><b>Double-click</b></span> on text to select it</p>
		<p><span class='helphighlight'><b>Right-click</b></span> to insert annotations, label data points, change element colors, and more.</p>
		<p><span class='helphighlight'><b>Drag</b></span> callouts, arrows, and floating keys.</p>
		<p><b>Remember</b> if you click the chart button you will lose anything you have added directly to the graph!</p>
	</div>
	<div class='helpbox' id='help_text'>
		<p><kbd><i class="fa fa-arrow-left"></i></kbd> / <kbd><i class="fa fa-arrow-right"></i></kbd> : move cursor</p>
		<p><kbd><i class="fa fa-arrow-up"></i></kbd> / <kbd><i class="fa fa-arrow-down"></i></kbd> : font size up/down</p>
		<p><kbd><b>shift</b></kbd> + <kbd><i class="fa fa-arrow-left"></i></kbd> / <kbd><i class="fa fa-arrow-right"></i></kbd> / <kbd><i class="fa fa-arrow-up"></i></kbd> / <kbd><i class="fa fa-arrow-down"></i></kbd> : nudge text</p>
		<p><kbd><b>ctrl</b></kbd> + <kbd><b>b</b></kbd> : bold</p>
		<p><kbd><b>ctrl</b></kbd> + <kbd><b>i</b></kbd> : italic</p>
		<p>You can also drag the selected text around the graphing area.</p>
	</div>
</div>

<div id='graphbox'>
	<svg id='grapharea' height='520px' width='745px'>
		<defs>
			<style>

			</style>
		</defs>
	</svg>
</div>

</div>
<div class='vspace'>
</div>

</div>

<footer class='footer'>
<div class='text-center unselectable bottom'>

<div class='btn-group' role='group'>
	<button type="button" class="btn btn-default" id='redraw1' onclick='redraw()'><i class="fa fa-line-chart"></i> Chart</button>
	<button type="button" class="btn btn-default" id='redraw2' onclick='redraw(1)'><i class="fa fa-refresh"></i> Redraw w/annotations</button>
</div>

<div class="btn-group" role="group">
	<button type="button" class="btn btn-default" id='savepng' onclick=savepng()><i class="fa fa-download"></i> Download PNG</button>
	<button type="button" class="btn btn-default" id='savesvg' onclick=savesvg()><i class="fa fa-arrows-h"></i> Download SVG</button>
</div>

<div class="btn-group" role="group">
	<button type="button" class="btn btn-default" id='savetext' onclick=cloudsave()><i class="fa fa-cloud-upload"></i> Save</button>
	<button type="button" class="btn btn-default" id='importtext' onclick=cloudload()><i class="fa fa-cloud-download"></i> Load</button>
</div>

<hr>
<small>[<a href='https://github.com/equitablegrowth/Playfair/#boards?repos=44823593'>report a bug</a>]</small>
</div>

<a href="JavaScript:void(0)" id='png_save' download="Playfair_graph.png" target="_blank"/></a>
<input id="filename" type="file" name="filename" style="display: none;" />

</div>
</footer>

<img id="png_save" style="clear:both;display:none;">

</body>

<script defer>

//////////////////////////////////////////////////////////////////////////////
//////////////////////////////// BEGIN SCRIPT ////////////////////////////////
//////////////////////////////////////////////////////////////////////////////

// Globals referenced by functions
var loadresponse
var loaded_data=0
var alerted=0
var graph_type=''
var dragging=0
var hovered=0
var height=520
var width=745
var chartobject
var clickedevent
var grapharea = Snap('#grapharea')
var drawpath
var loadfile
var annosize='14px'
var annoweight=400
var annoface='Lato'
var annofill='black'
var colormenu="<li><span class='colorbox' style='background-color:#205946' onclick=change_color(clickedevent.target,'#205946')></span><span class='colorbox' style='background-color:#33836A' onclick=change_color(clickedevent.target,'#33836A')></span><span class='colorbox' style='background-color:#67c2a5' onclick=change_color(clickedevent.target,'#67c2a5')></span><span class='colorbox' style='background-color:#b7dfd1' onclick=change_color(clickedevent.target,'#b7dfd1')></span><span class='colorbox' style='background-color:#e2f2ed' onclick=change_color(clickedevent.target,'#e2f2ed')></span></span><span class='colorbox' style='background-color:#ffffff' onclick=change_color(clickedevent.target,'#ffffff')></span></li><li><span class='colorbox' style='background-color:#8e2a1d' onclick=change_color(clickedevent.target,'#8e2a1d')></span><span class='colorbox' style='background-color:#c63f26' onclick=change_color(clickedevent.target,'#c63f26')></span><span class='colorbox' style='background-color:#f58c63' onclick=change_color(clickedevent.target,'#f58c63')></span><span class='colorbox' style='background-color:#fbcdbb' onclick=change_color(clickedevent.target,'#fbcdbb')></span><span class='colorbox' style='background-color:#fef1eb' onclick=change_color(clickedevent.target,'#fef1eb')></span></span><span class='colorbox' style='background-color:#000000' onclick=change_color(clickedevent.target,'#000000')></span></li><li><span class='colorbox' style='background-color:#24385B' onclick=change_color(clickedevent.target,'#24385B')></span><span class='colorbox' style='background-color:#3F578C' onclick=change_color(clickedevent.target,'#3F578C')></span><span class='colorbox' style='background-color:#8c9fca' onclick=change_color(clickedevent.target,'#8c9fca')></span><span class='colorbox' style='background-color:#ccdaf0' onclick=change_color(clickedevent.target,'#ccdaf0')></span><span class='colorbox' style='background-color:#f1f3f9' onclick=change_color(clickedevent.target,'#f1f3f9')></span></span><span class='colorbox' style='background-color:#a3a3a3' onclick=change_color(clickedevent.target,'#a3a3a3')></span></li><li><span class='colorbox' style='background-color:#e78ac3' onclick=change_color(clickedevent.target,'#e78ac3')></span><span class='colorbox' style='background-color:#a6d854' onclick=change_color(clickedevent.target,'#a6d854')></span><span class='colorbox' style='background-color:#ffd92f' onclick=change_color(clickedevent.target,'#ffd92f')></span><span class='colorbox' style='background-color:#e5c494' onclick=change_color(clickedevent.target,'#e5c494')></span><span class='colorbox' style='background-color:#ece9e8' onclick=change_color(clickedevent.target,'#ece9e8')></span></span><span class='colorbox' style='background-color:#c3c3c3' onclick=change_color(clickedevent.target,'#c3c3c3')></span></li>"
var shadowfilter=grapharea.filter(Snap.filter.shadow(1, 1, 1,'#333',1))
var theme
placeholder()
setInterval(blink,1000)

// save primaryload out with no output so fonts are loaded
// try{
// 	saveSvgAsPng(document.getElementById("primaryload"),{nooutput:1});
// } catch(err){
// 	console.log("Running offline, can't load fonts.")
// }
// saveSvgAsPng(document.getElementById("grapharea"),'none.png',{nooutput:1});

// set up cursor blink
// is this a stupid way to do this?
function blink(){
	try{
		cursor.attr({opacity:0})
		setTimeout(function(){cursor.attr({opacity:1})},500)
	} catch(err){}
}

// Initialize tooltips
$('[data-toggle="tooltip"]').tooltip()

// Initial graph state
function placeholder(){
	var bounding_box=grapharea.rect(0,0,width-.5,height-.5).attr({class:'background',fill:'none','stroke':'lightgray','stroke-width':3.5,'stroke-dasharray':'12,8','shape-rendering':'crispEdges'})
}

// Handlers for the graphing area
var active_element
var text_element_fill
var selected=0
grapharea.dblclick(edit_text)
grapharea.click(unselect_text)
grapharea.hover(highlight_element,unhighlight_element)

// on change in tab, set graph_type so when draw/refresh is clicked it draws the appropriate graph
// also, .click the first vertical tab
$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
	var tab=$('.nav-tabs .active').children()[0].getAttribute('href')
	$(tab+'_first').click()

	if ($('.nav-tabs .active').text()!='Design' && $('.nav-tabs .active').text()!='Settings' && $('.nav-tabs .active').text()!='Data' && $('.nav-tabs .active').text()!='Legend') {
		graph_type=$('.nav-tabs .active').text()
	}
});

//////////////////////////// FONT LOADER ////////////////////////////////
// want to add a new font? Add the name of the font to this list, then
// add a @font-face declaration at the beginning of this document to
// import the font (use the /fonts folder to store it). In Chrome you
// won't be able to use any of these fonts unless you are using a hosted
// version of Playfair because of CORS. Firefox however can use them
// offline.

fonts=["Lato","PTSans","Verdana","Georgia","Palatino","Garamond","Bookman","Arial","Helvetica","Impact","Courier","Courier New","Times","Times New Roman","Macondo","Archivo","Asap","BreeSerif","Cabin","Cuprum","Dosis","FjallaOne","Karma","Lora","Marvel","NewsCycle","Nunito","Oswald"]
fonts.sort()

///////////////////////// COLORMENU SETUP //////////////////////////////
// set up the initial state of the contextual colormenu

$('.colormenu').append(colormenu)

//////////////////////// LEGEND INTERFACE //////////////////////////////
// when a variable_select is changed, run preview() and check to see if
// any geom types have been completed. If they have, create a preview of
// what the key will look like by creating each grouping.

$(".variable_select").change(function(){
	var geom=preview()[0]
	// console.log(geom)
	var structure=[]

	// geom: {point:{xvar:x,yvar:y,grouping:{color:g1,type:g2}},line:{xvar:x,yvar:y,grouping:{color:g1,type:g2}}}
	for(var key in geom){
		if(key!=='trend'){
			var temp=geom[key]
			var xvar=temp['xvar']
			var yvar=temp['yvar']
			var groupingvars=0
			for(var grouper in temp.grouping){
				if(temp.grouping[grouper]!=='none'){
					// get all groups for this grouper - x and y must not be missing
					// xvar and yvar can totally be missing... I think. But if they were missing they would
					// be undefined, not empty strings.
					var groups=[]
					for(var i=0;i<datadict.length;i++){
						if(datadict[i][xvar]!=='' && datadict[i][yvar]!=='' && datadict[i][temp.grouping[grouper]]!==''){
							groups.push(datadict[i][temp.grouping[grouper]])
						}
					}

					groups=[... new Set(groups)]

					for(var i=0;i<groups.length;i++){
						var key_entry={}
						key_entry['geom']=key
						key_entry['grouping']=grouper
						key_entry['group_value']=groups[i]
						key_entry['group_variable']=temp.grouping[grouper]
						key_entry['xvar']=xvar
						key_entry['yvar']=yvar
						structure.push(key_entry)
					}

					groupingvars=1
				}
			}

			if(groupingvars==0 && Object.keys(geom).length>1){
				var key_entry={}
				key_entry['geom']=key
				key_entry['grouping']='none'
				key_entry['group_value']=yvar
				if(key=='shade'){key_entry['group_value']=temp['legend_head']}
				key_entry['group_variable']='none'
				key_entry['xvar']=xvar
				key_entry['yvar']=yvar
				structure.push(key_entry)
			}
		}
	}

	// final structure is:
	// [ {geom='point',grouping='color',group_value='g1',group_variable='groupvar',xvar='xvar',yvar='yvar'} ... ]
	// console.log(structure)

	if(structure.length>0){
		$('#PREVIEW').empty()
		// $('#PREVIEWbase').prepend("<div id='PREVIEW'></div>")
		$('#PREVIEW').prepend("Use the preview below to delete key items you don't want (by clicking the x), change the order of items, and arrange them in groups.")

		var geoms=[]

		for(var i=0;i<structure.length;i++){
			geoms.push(structure[i]['geom'])
		}

		console.log(geoms,structure)
		// combos stores xvar yvar grouping_variable combos to check future key items against for consolidation
		var combos=[]
		// created stores geom+grouping combos to set up the appropriate number of groups
		var created=[]
		// keycount is used to track how many key items are created
		var keycount=0

		for(var i=0;i<structure.length;i++){
			if(structure[i].geom!='text'){
				created.push()
				var temp=structure[i]
				if(created.indexOf(temp.xvar+temp.yvar+temp.group_variable)==-1){
					var l_xvar=temp.xvar
					var l_yvar=temp.yvar
					var l_group_variable=temp.group_variable
					if(l_xvar===undefined){l_xvar='none'}
					if(l_yvar===undefined){l_yvar='none'}
					if(l_group_variable===undefined){l_group_variable='none'}
					$('#PREVIEW').append("<ul id='"+l_xvar.replace(/\s+/g, '-')+l_yvar.replace(/\s+/g, '-')+l_group_variable.replace(/\s+/g, '-')+"sortable' class='connectedSortable'>")
				}
				created.push(temp.xvar+temp.yvar+temp.group_variable)
			}
		}

		var groupnumeric=0
		var current=structure[0].geom+structure[0].grouping
		for(var i=0;i<structure.length;i++){
			if(structure[i].geom!='text'){
				var temp=structure[i]
				var l_xvar=temp.xvar
				var l_yvar=temp.yvar
				var l_group_variable=temp.group_variable
				if(l_xvar===undefined){l_xvar='none'}
				if(l_yvar===undefined){l_yvar='none'}
				if(l_group_variable===undefined){l_group_variable='none'}
				if (temp.geom+temp.grouping!=current){
					current=temp.geom+temp.grouping
					var groupnumeric=0
				}
				if(combos.indexOf(temp.xvar+temp.yvar+temp.group_variable+temp.group_value)==-1){
					$('#'+l_xvar.replace(/\s+/g, '-')+l_yvar.replace(/\s+/g, '-')+l_group_variable.replace(/\s+/g, '-')+'sortable').append('<li class="ui-state-default" id=keyitem'+i+' data-string="'+temp.xvar+temp.yvar+temp.group_variable+temp.group_value+'" data-geom='+temp.geom+' data-grouping='+temp.grouping+' data-group_value="'+temp.group_value+'" data-group_variable="'+temp.group_variable+'" data-xvar="'+temp.xvar+'" data-yvar="'+temp.yvar+'" data-groupnumeric='+groupnumeric+' >'+temp.geom+' | '+temp.group_variable+' = '+temp.group_value+'<div class="xbox" onclick=destroy("keyitem'+i+'")></div></li>')
					keycount=keycount+1
					combos.push(temp.xvar+temp.yvar+temp.group_variable+temp.group_value)
				} else {
					var exist_geom=$('[data-string="'+temp.xvar+temp.yvar+temp.group_variable+temp.group_value+'"]').attr('data-geom')
					$('[data-string="'+temp.xvar+temp.yvar+temp.group_variable+temp.group_value+'"]').attr('data-geom',exist_geom+','+temp.geom)
					$('[data-string="'+temp.xvar+temp.yvar+temp.group_variable+temp.group_value+'"]').html(exist_geom+','+temp.geom+' | '+temp.group_variable+' = '+temp.group_value)
				}
				groupnumeric=groupnumeric+1
			}
		}

		var string=''
		for(var i=0;i<structure.length;i++){
			var temp=structure[i]
			var l_xvar=temp.xvar
			var l_yvar=temp.yvar
			var l_group_variable=temp.group_variable
			if(l_xvar===undefined){l_xvar='none'}
			if(l_yvar===undefined){l_yvar='none'}
			if(l_group_variable===undefined){l_group_variable='none'}
			string=string+'#'+l_xvar.replace(/\s+/g, '-')+l_yvar.replace(/\s+/g, '-')+l_group_variable.replace(/\s+/g, '-')+'sortable'+', '
		}
		string=string.slice(0,-2)
		console.log(string)

		$(function() {
			// console.log(string)
			$(string).sortable({
				connectWith:'.connectedSortable'
			}).disableSelection()
		})

		if(keycount===1){
			$('#PREVIEW').empty()
			// $('#PREVIEWbase').prepend("<div id='PREVIEW'></div>")
			$('#PREVIEW').prepend("Select your variables from the chart tab, then come back here to see a preview of the legend and to make modifications. Currently, no legend will be created.")
		}
	} else {
		$('#PREVIEW').empty()
		// $('#PREVIEWbase').prepend("<div id='PREVIEW'></div>")
		$('#PREVIEW').prepend("Select your variables from the chart tab, then come back here to see a preview of the legend and to make modifications. Currently, no legend will be created.")
	}
})

// from stackoverflow - Justin Johnson - http://stackoverflow.com/a/1890233/3001940
function unique(arr) {
    var hash = {}, result = [];
    for ( var i = 0, l = arr.length; i < l; ++i ) {
        if ( !hash.hasOwnProperty(arr[i]) ) { //it works with objects! in FF, at least
            hash[ arr[i] ] = true;
            result.push(arr[i]);
        }
    }
    return result;
}

// from stackoverflow - Adam Rackis - http://stackoverflow.com/a/22395370/3001940
function arraysAreIdentical(arr1, arr2){
    if (arr1.length !== arr2.length) return false;
    for (var i = 0, len = arr1.length; i < len; i++){
        if (arr1[i] !== arr2[i]){
            return false;
        }
    }
    return true; 
}

// xbox deletion
function destroy(id){
	console.log(id)
	$('#'+id).remove()
}

// reset all fields
$(document).ready(function(){
	base_input_dict={}
	var inputs, index;

	inputs = document.getElementsByTagName('input');
	for (index = 0; index < inputs.length; ++index) {
	    if(inputs[index].type=='radio' || inputs[index].type=='checkbox'){
	    	base_input_dict[inputs[index].id]=[inputs[index].type,inputs[index].checked]
	    } else if (inputs[index].type=='text'){
	    	base_input_dict[inputs[index].id]=[inputs[index].type,inputs[index].value]
	    }
	}

	selects=document.getElementsByTagName('select');
	for (index=0; index < selects.length; ++index){
		base_input_dict[selects[index].id]=['dropdown',selects[index].value]
	}

	base_input_dict['graphtype']=['graphtype',graph_type]
})

function reset(){
	$('#data_text').val('').blur()
	loadData()
	$(".variable_select").trigger('change')
	populate_variables()

	alertbox.className = "alert alert-success";
	alertbox.innerHTML = "<b>Enter some data and I'll diagnose it for you</b>"
	alertbox.style.display='block'

	for(var input in base_input_dict){
		if(base_input_dict[input][0]=='text'){
			$('#'+input).val(base_input_dict[input][1])
		}
		if(base_input_dict[input][0]=='radio'){
			$('#'+input).prop('checked',base_input_dict[input][1])
		}
		if(base_input_dict[input][0]=='checkbox'){
			$('#'+input).prop('checked',base_input_dict[input][1])
		}
		if(base_input_dict[input][0]=='dropdown'){
			$('#'+input).val(base_input_dict[input][1])
		}
		if(base_input_dict[input][0]=='graphtype'){
			graph_type=base_input_dict[input][1]
		}
	}

	if (base_input_dict['gwidth'][1]!=''){
		width=parseFloat(base_input_dict['gwidth'][1])
	} else {width=745}
	if (base_input_dict['gheight'][1]!=''){
		height=parseFloat(base_input_dict['gheight'][1])
	} else {height=520}

	$('#grapharea').attr('height',height)
	$('#grapharea').attr('width',width)
}

// listen for key presses in the searchahead box to filter search list
$('#searchahead').keyup(function(){
	$('#load_filebox').empty()
	temploadresponse=$.grep(loadresponse,function(n,i){
		return n.toLowerCase().indexOf($('#searchahead').val().toLowerCase())>-1
	})
	for (var i=0;i<temploadresponse.length;i++){
		$('#load_filebox').append('<a href="#" class="list-group-item filerow">'+temploadresponse[i]+'</a')
	};
})


</script>
</html>
